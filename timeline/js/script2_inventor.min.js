var timeline;function dateFormat(a){var b=a.getFullYear()+"-"+((a.getMonth()<9)?"0":"")+(a.getMonth()+1)+"-"+((a.getDate()<10)?"0":"")+a.getDate()+" "+((a.getHours()<10)?"0":"")+a.getHours()+":"+((a.getMinutes()<10)?"0":"")+a.getMinutes()+":"+((a.getSeconds()<10)?"0":"")+a.getSeconds();return b}function setTime(){if(!timeline){return}var b=new Date(document.getElementById("startDate").value.replace(/-/g,"/"));var a=new Date(document.getElementById("endDate").value.replace(/-/g,"/"));timeline.setVisibleChartRange(b,a)}function setCurrentTime(){if(!timeline){return}timeline.setVisibleChartRangeNow();onrangechange()}function onrangechange(){var a=timeline.getVisibleChartRange();document.getElementById("startDate").value=dateFormat(a.start);document.getElementById("endDate").value=dateFormat(a.end)}function handleDate(){var a=new Date();var b=("0"+a.getDate()).slice(-2);var e=("0"+(a.getMonth()+1)).slice(-2);var c=a.getFullYear();var d=c+""+e+""+b;return d}function guidance(f){var b=0,j=0,g=0,e=0;var d="\uf1b9",a="\uf183",k="\uf043",h="\uf16b";var c=[];for(i in f){if(f[i].activity=="transport"){j++}else{if(f[i].activity=="walking"){g++}else{if(f[i].activity=="cleaning"){e++}else{b++}}}}console.log(b,j,g,e);if(b>0){c.push({type:"other",value:h})}if(g>0){c.push({type:"walking",value:a})}if(j>0){c.push({type:"transport",value:d})}if(e>0){c.push({type:"cleaning",value:k})}console.log(c);return c}$.getJSON("farzad_moves2.json",function(G){var D,x,H=[],F=[],n=[],A=G,p=[];if(typeof A=="string"||A instanceof String){A=JSON.parse(A)}console.log(A);if(A[0]!=null){for(D=A.length;D--;){if(A[D].length&&A[D].length>0){if(typeof(A[D][0].summary)!="undefined"&&A[D][0].summary!=null){n.push(A[D][0])}}else{if(A[D].summary){n.push(A[D])}else{if(typeof(A[D].summary)==undefined||A[D].summary==null){n.push(A[D])}}}}}else{n=[{date:handleDate()}]}console.log(n);var B=[],E=[];for(D=n.length;D--;){if(n[D].summary!=null&&n[D].summary!="undefined"){for(x=0;x<n[D].summary.length;x++){if(typeof(n[D].summary[x])!="undefined"&&n[D].summary[x]!=null){H.push(n[D].summary[x]);F.push(n[D].date);for(var v in H){H[v]["date"]=F[v]}}else{H.push(n[D].summary[x])}}}else{if(n[D].summary==null&&n[D].date!=null){var s={duration:null,steps:null,distance:null,calories:null,activity:null};B.push(n[D].date);console.log(B);E.push(s);for(var v in E){E[v]["date"]=B[v]}}else{H=[{duration:null,steps:null,distance:null,calories:null,date:handleDate()}]}}}for(var v in E){H.push(E[v])}console.log(E);console.log(H);function C(K){var N=[];var M={};for(var I=0;I<K.length;I++){var J=Object.keys(K[I]);J.sort(function(P,O){return P-O});var L="";for(var f=0;f<J.length;f++){L+=JSON.stringify(J[f]);L+=JSON.stringify(K[I][J[f]])}if(!M.hasOwnProperty(L)){N.push(K[I]);M[L]=true}}return N}var q=C(H);console.log("THIS IS PURE DATA WITHOUT DUPLICATE",q);H=q;var k=[],b=[],j=[],l=[],w=[],o=[],z=[],d=[],h=[],a=[],y=[],c=[],m=[];var g=["red","green","orange","magenta","brown","Darkblue","violet","black"];for(D in H){if(H[D].activity){l[D]=new Date(((H[D].date).slice(0,4))+"/"+((H[D].date).slice(4,6))+"/"+((H[D].date).slice(6))+" "+Math.floor((Math.random()*22)+1)+":"+Math.floor((Math.random()*59)+1)+":"+Math.floor((Math.random()*59)+1)+"");k[D]={start:l[D]};b[D]=l[D];if(H[D].steps){z[D]=H[D].steps}else{z[D]="No steps"}if(H[D].distance){h[D]=H[D].distance/1000}else{h[D]="No distance"}if(H[D].group){m[D]=H[D].group}else{m[D]="uncalssified"}d[D]=H[D].activity;a[D]=Math.round(H[D].duration/60);o.push(k[D]);var r=new Date(l);j[D]=new Date(r.setMinutes((r.getMinutes())+(H[D].duration/60)));o[D]["activity"]=d[D];o[D]["duration"]=a[D];o[D]["distance"]=h[D];o[D]["steps"]=z[D];if((H[D].activity)=="transport"){o[D]["className"]=g[7];o[D]["content"]="<i class='fa fa-suitcase fa-2x'></i><span> <b> "+a[D]+"</b> Minutes</br>Transporting - <b>"+h[D]+"</b> Km </span>";o[D]["type"]="box"}else{if((H[D].activity)=="walking"){if(H[D].steps<1800){o[D]["className"]=g[0];o[D]["content"]="<i class='fa fa-bar-chart fa-2x'></i><span> Analyse: <b>"+z[D]+"</b></br></span><g class= 'tooltip' >You had <b>"+z[D]+"</b> steps to reach the resturant.</br>Distance was<b> "+h[D]+"</b> Km and you reach the place in <b>"+a[D]+"</b> Minutes</br>You started at "+b[D].getHours()+":"+b[D].getMinutes()+":"+b[D].getSeconds()+"</br>"+u(z[D])+"</g>"}else{if(H[D].steps>5100){o[D]["className"]=g[1];o[D]["content"]="<i class='fa fa-book fa-2x'></i><span> Lines: <b>"+z[D]}else{if(H[D].steps>2500&&H[D].steps<3500){o[D]["className"]=g[2];o[D]["content"]="<i class='fa fa-laptop fa-2x'></i><span> Working: <b>"+a[D]+"</b> Minutes </span>"}else{if(H[D].steps>1800&&H[D].steps<2501){o[D]["className"]=g[0];o[D]["content"]="<i class='fa fa-code fa-2x'></i><span> Lines: <b>"+z[D]+"</b></br><b>"+a[D]+"</b> Minutes </span>"}else{o[D]["className"]=g[3];o[D]["content"]="<i class='fa fa-comments fa-2x'></i><span> Words: <b>"+z[D]+"</b></br><b>"+a[D]+"</b> Minutes </span>"}}}}}else{if((H[D].activity)=="yoga"){o[D]["className"]=g[4];o[D]["content"]="<i class='fa fa-graduation-cap fa-3x'></i><span> <b>"}else{if((H[D].activity)=="cleaning"){o[D]["className"]=g[5];o[D]["content"]="<i class='fa fa-edit fa-2x'></i><span> <b>"+a[D]+"</b> Minutes </span>"}else{if((H[D].activity)=="dancing"){o[D]["className"]=g[6];o[D]["content"]="<i class='fa fa-users fa-2x'></i><span> <b>"+a[D]+"</b> Minutes </span>"}else{o[D]["className"]=g[7];o[D]["content"]="<i class='fa fa-car fa-2x'></i><span> Steps: <b>"+z[D]+"</b></br><b> "+h[D]+"</b> Km in <b>"+a[D]+"</b> Minutes </span>"}}}}}}else{if(H[D].date&&A[0]==null){l=new Date(((H[D].date).slice(0,4))+","+((H[D].date).slice(4,6))+","+((H[D].date).slice(6)));k[D]={start:l};z[D]="No steps";h[D]="No distance";o.push(k[D]);o[D]["content"]="<div><span style = 'text-transform:capitalize; font-size: 26px; font-weight: 400;'> NO ACTIVITY FOUND</div></br>until "+l}}}function u(f){if(f<2500){return'<img src="img/rest.jpg" /> <img src="img/rest2.jpg" /> <img src="img/rest3.jpg" />'}else{return'<img src="img/food.jpg"/> <img src="img/food2.jpg" /> <img src="img/food3.jpg" />'}}console.log("GENERATED DATA JUST FOR TIMELINE",o.length,"in length",o);var e={width:"100%",height:"auto",style:"box",cluster:true,animate:true,showNavigation:false,eventMargin:5,showNavigation:true,zoomMax:51000000000,zoomMin:20000000,stackEvents:true,showMajorLabels:true,"box.align":"left"};timeline=new links.Timeline(document.getElementById("mytimeline"),e);timeline.draw(o);onrangechange();var t=guidance(o);d3.select("#guide").selectAll("text").data(t).enter().append("text").attr("class","text").text(function(f){return f.value+" "+f.type+" | "})});jQuery(document).ready(function(b){var a=new Date();b("#time").html("Today: "+a).css("font-size","100%")});